"use strict";!function(t){function e(e){var n=t(".page-body"),o=t(".searchbox"),a=n.attr("data-page-id");n.load("/"+e,function(r,i,c){if("success"===i){var s=n.find(".page").attr("data-page-id");s?(a&&window.JSVIEW[a]&&(window.JSVIEW[a].destroy||t.noop)(n),o.toggle(!!n.find(".page.with-searchbox").length),n.off("searchbox:search"),n.attr("data-page-id",s),window.JSVIEW[s]&&(window.JSVIEW[s].ready||t.noop)(n)):(o.hide(),n.empty(),swal({title:"Page id not found",text:"The page script can not be executed",type:"error"}))}else o.hide(),n.empty(),swal({title:"Page not found",text:e,type:"error"})})}function n(t,e,n,o){var a=Rx.Observable.merge(Rx.Observable.fromEvent(t,"keyup"),Rx.Observable.fromEvent(t,"blur")).map(function(t){return t.target.value.trim().toUpperCase()}).filter(function(t){return 0===t.length||t.length>=e}).debounce(n).distinctUntilChanged(),r=Rx.Observable.fromEvent(t,"rx-search-force").map(function(t){return t.target.value.trim()}).debounce(n),i=Rx.Observable.fromEvent(t,"rx-search-force-now").map(function(t){return t.target.value.trim()});Rx.Observable.merge(a,r,i).subscribe(o)}window.JSVIEW={},t(function(){var o="sync";window.onhashchange=function(){e(location.hash.substr(1)||o)},n(t(".searchbox>input"),3,500,function(e){t(".page-body").trigger("searchbox:search",e)}),e(location.hash.substr(1)||o)})}(jQuery),function(t){window.JSVIEW.remote={ready:function(e){t("button[data-action]",e).click(function(e){e.stopPropagation(),e.preventDefault();var n=e.target.attributes["data-action"].value,o=e.target.attributes["data-confirm-title"].value,a=e.target.attributes["data-confirm-message"].value;swal({title:o,text:a,showCancelButton:!0},function(e){e&&t.get("/remote/"+n).then(function(){setTimeout(function(){document.location.reload(!0)},500)}).fail(function(t,e,n){swal({title:"Load processes",text:e+": "+n,type:"error"})})})})}}}(jQuery),function(t){var e=2e3,n=void 0,o=void 0;window.JSVIEW.sync={ready:function(a){var r=t("#qrcode",a),i=r.attr("data-sid"),c=+r.attr("data-timeout")||3e4,s=c/e;r.qrcode({width:256,height:256,text:i}),t("#btnNewCode",a).click(function(t){document.location.reload()}),o=new WebSocket("ws://localhost:3000/sync/wsh"),o.onerror=function(t){console.log(t)},o.onmessage=function(e){var c=JSON.parse(e.data);c.synced?document.location.href="#sync/comics/"+i:--s||(r.hide(),t("#btnNewCode",a).show(),clearInterval(n),o.close())},n=setInterval(function(){o.send(JSON.stringify({type:"check",sid:i}))},e)},destroy:function(t){clearInterval(n),o.close()}}}(jQuery),function(t){window.JSVIEW.synccomics={ready:function(e){e.on("searchbox:search",function(e,n){n?!function(){var e=n.split(/\s/),o=(e.length,new RegExp("("+n.replace(/\s/g,"|")+")","gi"));t(".comics-list>.comics").hide().filter(function(t,n){var a=n.attributes["data-search"].value.match(o);return a&&0===_.difference(e,a).length}).show()}():t(".comics-list>.comics").show()})}}}(jQuery),function(t){var e={datetime:function(t){return moment(+t).format("YYYY-MM-DD HH:mm:ss")},status:function(t){return e[t]||t},0:"NO_SYNC",1:"SYNCED",3:"DATA_RECEIVED"};window.JSVIEW.synclist={ready:function(n){t("[data-format]",n).each(function(t,n){n.innerHTML=e[n.attributes["data-format"].value](n.innerText)}),t("a[data-action]",n).click(function(e){e.stopPropagation(),e.preventDefault();var n=e.target.attributes["data-action"].value,o=e.target.attributes["data-sid"].value;swal({title:n.capitalize()+" "+o+"?",showCancelButton:!0,closeOnConfirm:!0},function(e){e&&setTimeout(function(){"sync"===n?t.post("/sync/"+o).then(function(){location.reload()}).fail(function(t,e,n){swal({title:"Sync",text:e+": "+n,type:"error"})}):"expire"===n?t.post("/sync/change/"+o,{lastSync:Date.now()-3e4}).then(function(){location.reload()}).fail(function(t,e,n){swal({title:"Expire",text:e+": "+n,type:"error"})}):"remove"===n&&t.post("/sync/remove/"+o).then(function(){location.reload()}).fail(function(t,e,n){swal({title:"Remove",text:e+": "+n,type:"error"})})},100)})})}}}(jQuery),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};
//# sourceMappingURL=all.min.js.map

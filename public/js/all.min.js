"use strict";!function(t){function e(e){var n=t(".page-body"),a=t(".searchbox"),o=n.attr("data-page-id");n.load("/"+e,function(r,i,c){if("success"===i){var s=n.find(".page").attr("data-page-id");s?(o&&window.JSVIEW[o]&&(window.JSVIEW[o].destroy||t.noop)(n),a.toggle(!!n.find(".page.with-searchbox").length),n.off("searchbox:search"),n.attr("data-page-id",s),window.JSVIEW[s]&&(window.JSVIEW[s].ready||t.noop)(n)):(a.hide(),n.empty(),swal({title:"Page id not found",text:"The page script can not be executed",type:"error"}))}else a.hide(),n.empty(),swal({title:"Page not found",text:e,type:"error"})})}function n(t,e,n,a){var o=Rx.Observable.merge(Rx.Observable.fromEvent(t,"keyup"),Rx.Observable.fromEvent(t,"blur")).map(function(t){return t.target.value.trim().toUpperCase()}).filter(function(t){return 0===t.length||t.length>=e}).debounce(n).distinctUntilChanged(),r=Rx.Observable.fromEvent(t,"rx-search-force").map(function(t){return t.target.value.trim()}).debounce(n),i=Rx.Observable.fromEvent(t,"rx-search-force-now").map(function(t){return t.target.value.trim()});Rx.Observable.merge(o,r,i).subscribe(a)}window.JSVIEW={},t(function(){var a="sync";window.onhashchange=function(){e(location.hash.substr(1)||a)},n(t(".searchbox>input"),3,500,function(e){t(".page-body").trigger("searchbox:search",e)}),e(location.hash.substr(1)||a)})}(jQuery),function(t){window.JSVIEW.remote={ready:function(e){t("button[data-action]",e).click(function(e){e.stopPropagation(),e.preventDefault();var n=e.target.attributes["data-action"].value,a=e.target.attributes["data-confirm-title"].value,o=e.target.attributes["data-confirm-message"].value;swal({title:a,text:o,showCancelButton:!0},function(e){e&&t.get("/remote/"+n).then(function(){setTimeout(function(){document.location.reload(!0)},500)}).fail(function(t,e,n){swal({title:"Load processes",text:e+": "+n,type:"error"})})})})}}}(jQuery),function(t){var e=2e3,n=void 0;window.JSVIEW.sync={ready:function(a){var o=t("#qrcode",a),r=o.attr("data-sid"),i=+o.attr("data-timeout")||3e4,c=i/e;o.qrcode({width:256,height:256,text:r}),t("#btnNewCode",a).click(function(t){document.location.reload()}),n=setInterval(function(){t.get("/sync/check/"+r).then(function(e){e.synced?document.location.href="#sync/comics/"+r:--c||(o.hide(),t("#btnNewCode",a).show(),clearInterval(n))}).fail(function(t,e,a){clearInterval(n),swal({title:"Sync",text:e+": "+a,type:"error"},function(){document.location.reload()})})},e)},destroy:function(t){clearInterval(n)}}}(jQuery),function(t){window.JSVIEW.synccomics={ready:function(e){e.on("searchbox:search",function(e,n){n?!function(){var e=n.split(/\s/),a=(e.length,new RegExp("("+n.replace(/\s/g,"|")+")","gi"));t(".comics-list>.comics").hide().filter(function(t,n){var o=n.attributes["data-search"].value.match(a);return o&&0===_.difference(e,o).length}).show()}():t(".comics-list>.comics").show()})}}}(jQuery),function(t){var e={datetime:function(t){return moment(+t).format("YYYY-MM-DD HH:mm:ss")},status:function(t){return e[t]||t},0:"NO_SYNC",1:"SYNCED",2:"DATA_RECEIVED"};window.JSVIEW.synclist={ready:function(n){t("[data-format]",n).each(function(t,n){n.innerHTML=e[n.attributes["data-format"].value](n.innerText)}),t("a[data-action]",n).click(function(e){e.stopPropagation(),e.preventDefault();var n=e.target.attributes["data-action"].value,a=e.target.attributes["data-sid"].value;swal({title:n.capitalize()+" "+a+"?",showCancelButton:!0,closeOnConfirm:!0},function(e){e&&setTimeout(function(){"sync"===n?t.post("/sync/"+a).then(function(){location.reload()}).fail(function(t,e,n){swal({title:"Sync",text:e+": "+n,type:"error"})}):"expire"===n?t.post("/sync/change/"+a,{lastSync:Date.now()-3e4}).then(function(){location.reload()}).fail(function(t,e,n){swal({title:"Expire",text:e+": "+n,type:"error"})}):"remove"===n&&t.post("/sync/remove/"+a).then(function(){location.reload()}).fail(function(t,e,n){swal({title:"Remove",text:e+": "+n,type:"error"})})},100)})})}}}(jQuery),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};
//# sourceMappingURL=all.min.js.map
